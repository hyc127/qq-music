define("js/v4/radio.js", function (i) { var a = i("js/common/music.js"), e = a.$; window.$ = e, MUSIC = a, jQueryAjax = a.jQueryAjax, g_user = a.widget.user, popup = a.popup, statistics = a.statistics; var o = function () { function i(i) { document.documentElement.scrollTop = document.body.scrollTop = i } function a(i) { if (MUSIC.cookie.set("yq_playdata", "r_" + i), MUSIC.cookie.set("yq_playschange", 1), MUSIC.player.isExists()) MUSIC.cookie.set("player_exist", 0), popup.show("已经加入播放器！"), setTimeout(function () { var a = parseInt(MUSIC.cookie.get("player_exist")); if (!a) { var e = window.open("//y.qq.com/portal/player_radio.html#id=" + i, "_blank"); e && (e.opener = null) } }, 2e3); else { popup.show("已经加入播放器！"); var a = window.open("//y.qq.com/portal/player_radio.html#id=" + i, "_blank"); a && (a.opener = null) } } function o() { var i = l.scrollTop(), a = e("div.footer").offset().top; e(".mod_radio_sidebar a.radio_sidebar__item").first().offset().top + 8 > i || i > d && a > e(".mod_radio_sidebar a.radio_sidebar__item").last().offset().top + 100 ? e(".mod_radio_sidebar").css({ top: i - d + 30 + "px" }) : e(".mod_radio_sidebar").css({ top: a - e("#taglist").height() - 150 + "px" }), 210 > i && e(".mod_radio_sidebar").css({ top: "35px" }); for (var o = !1, t = 0; g > t; t++)if (i <= m[t] - window.innerHeight / 2) { o = !0, e(".radio_sidebar__item").removeClass("radio_sidebar__item--current"), e(".radio_sidebar__item:eq(" + (t - 1 > 0 ? t - 1 : 0) + ")").addClass("radio_sidebar__item--current"); break } o || (e(".radio_sidebar__item").removeClass("radio_sidebar__item--current"), e(".radio_sidebar__item:eq(" + (g - 1) + ")").addClass("radio_sidebar__item--current")) } function t() { l.on("scroll", o).on("click", ".radio_sidebar__item", function () { var a = e(this).data("index"); i(m[a] - 10), o(), statistics.pgvClickStat("y_new.radio.tab." + a) }).on("click", ".js_radio", function () { var i = parseInt(e(this).parents("li.radio_list__item").data("id")); return statistics.pgvClickStat("y_new.radio.play." + i), 99 == i && g_user.getUin() < 1e4 ? (g_user.openLogin(), !1) : (a(i), void 0) }) } function r() { e("div.mod_radio").append(c(u)), e("img", "div.mod_radio").each(function () { "//y.gtimg.cn/mediastyle/global/img/album_300.png?max_age=31536000" == e(this).attr("src") && e(this).lazyload({ effect: "fadeIn" }) }), setTimeout(function () { e.each(e(".radio__item"), function (i, a) { m.push(e(a).offset().top) }), g = m.length, o() }, 300) } function s(i) { var a = "//c.y.qq.com/v8/fcg-bin/fcg_v8_radiolist.fcg?channel=radio&format=jsonp&page=index&tpl=wk&new=1&p=" + Math.random(); jQueryAjax.jsonp({ url: a, charset: "utf-8", success: function (a) { 0 == a.code ? (e("#before_page").hide(), e(".main").show(), i && i(a.data)) : MUSIC.popup.show("网络繁忙，请稍后再试！", 3e3, 1) }, error: function () { MUSIC.popup.show("网络繁忙，请稍后再试！", 3e3, 1) } }) } function n() { e("div#taglist").append(p(u)) } var d = 180, l = e(document), c = function (i) { { var a, e = ""; Array.prototype.join } e += "	"; for (var o = 0; o < i.groupList.length; o++) { for (var t = i.groupList[o], r = [], s = 0; s < t.radioList.length; s++) { var n = t.radioList[s]; if (i.gmgg && n.radioId in i.gmgg) { var d = i.gmgg[n.radioId], l = Math.floor(Math.random() * d.length); r.push(d[l]) } else r.push(n) } e += '\n		<div class="radio__item">\n    			<h2 class="radio__tit">' + (null == (a = t.name || "") ? "" : _.escape(a)) + '</h2>\n    			<div class="mod_radio_list">\n	                <ul class="radio_list__list">\n						'; for (var c = 0; c < r.length; c++) { var t = r[c]; e += '\n	                    <li class="radio_list__item" data-id="' + (null == (a = t.radioId) ? "" : a) + '" data-name="' + (null == (a = t.radioName || "") ? "" : _.escape(a)) + '" data-pos="' + (null == (a = c + 1) ? "" : a) + '" data-cid="' + (null == (a = t.type) ? "" : a) + "\" data-json='" + (null == (a = JSON.stringify(t)) ? "" : a) + '\'>\n	                        <div class="radio_list__item_box">\n	                            <div class="radio_list__cover mod_cover"><a href="javascript:;" class="js_radio"><img data-original="' + (null == (a = t.radioImg) ? "" : a) + '" alt="' + (null == (a = t.radioName || "") ? "" : _.escape(a)) + '" src="//y.gtimg.cn/mediastyle/global/img/album_300.png?max_age=31536000" onerror="this.src=\'//y.gtimg.cn/mediastyle/global/img/album_300.png?max_age=31536000\';this.onerror=null;" class="radio_list__pic"><i class="mod_cover__mask"></i><i class="mod_cover__icon_play"></i></a></div>\n	                            <h4 class="radio_list__title"><span class="radio_list__title_txt"><a href="javascript:;" class="js_radio" title="' + (null == (a = t.radioName || "") ? "" : _.escape(a)) + '">' + (null == (a = t.radioName || "") ? "" : _.escape(a)) + '</a></span></h4>\n	                            <div class="radio_list__other">\n	                                播放量：' + (null == (a = parseInt(t.listenNum, 10) >= 1e4 ? ((t.listenNum / 1e4).toFixed(1) + "万").replace(".0万", "万") : t.listenNum) ? "" : a) + "\n	                            </div>\n	                        </div>\n	                    </li>\n\n						" } e += "\n	                </ul>\n	            </div>\n    		</div>\n	" } return e += "\n" }, p = function (i) { { var a, e = ""; Array.prototype.join } e += "\n	"; for (var o = 0; o < i.groupList.length; o++)e += '\n    		<a href="javascript:;" class="radio_sidebar__item', 0 == o && (e += " radio_sidebar__item--current"), e += '" data-id="' + (null == (a = i.groupList[o].type) ? "" : a) + '" data-index="' + (null == (a = o) ? "" : a) + '">' + (null == (a = i.groupList[o].name || "") ? "" : _.escape(a)) + "</a>\n	"; return e += "" }, u = null, m = [], g = 0; return { init: function () { s(function (i) { u = i.data, n(), r() }), t(), i(0) } } }(); return o });